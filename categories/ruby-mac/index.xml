<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Ruby Mac on status code 51</title>
    <link>http://blog.tanaka51.jp/categories/ruby-mac/</link>
    <description>Recent content in Ruby Mac on status code 51</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>ja</language>
    <lastBuildDate>Sun, 03 Feb 2013 22:27:00 +0000</lastBuildDate>
    <atom:link href="http://blog.tanaka51.jp/categories/ruby-mac/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>install ruby on mac</title>
      <link>http://blog.tanaka51.jp/2013/02/03/install-ruby-on-mac/</link>
      <pubDate>Sun, 03 Feb 2013 22:27:00 +0000</pubDate>
      
      <guid>http://blog.tanaka51.jp/2013/02/03/install-ruby-on-mac/</guid>
      <description>

&lt;p&gt;Ruby 1.9.3-p374 を Mac にインストールしようとしたら一発でできなかったのでメモ。&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;OS: OSX 10.8.2 (moutain lion)&lt;/li&gt;
&lt;li&gt;rvm: 1.18.5&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;3行でまとめると、&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;MacPorts をアンインストール&lt;/li&gt;
&lt;li&gt;Homebrew に完全移行&lt;/li&gt;
&lt;li&gt;&lt;code&gt;rm -rf ~/.rvm/usr&lt;/code&gt; (不要な rvm pkg をアンインストール)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;という事になる。&lt;/p&gt;

&lt;p&gt;最新の Ruby のインストールは、Homebrew のライブラリが相性が良いのかなーという印象。正しいかどうかは分からない。&lt;/p&gt;

&lt;p&gt;以後、長いけれども、作業メモ。&lt;/p&gt;

&lt;p&gt;&lt;code&gt;rvm install ruby&lt;/code&gt; したらこんなエラー。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;koichi% rvm install ruby
Searching for binary rubies, this might take some time.
No binary rubies available for: osx/10.8/x86_64/ruby-1.9.3-p374.
Continuing with compilation. Please read &#39;rvm mount&#39; to get more information on binary rubies.
Installing Ruby from source to: /Users/koichi/.rvm/rubies/ruby-1.9.3-p374, this may take a while depending on your cpu(s)...
ruby-1.9.3-p374 - #downloading ruby-1.9.3-p374, this may take a while depending on your connection...
ruby-1.9.3-p374 - #extracted to /Users/koichi/.rvm/src/ruby-1.9.3-p374 (already extracted)
ruby-1.9.3-p374 - #configuring
ruby-1.9.3-p374 - #compiling
Error running &#39;make&#39;, please read /Users/koichi/.rvm/log/ruby-1.9.3-p374/make.log
There has been an error while running make. Halting the installation.
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;エラー起こしてる make の log はこんな感じ。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;compiling openssl_missing.c
In file included from openssl_missing.c:22:
openssl_missing.h:71: error: conflicting types for &#39;HMAC_CTX_copy&#39;
/opt/local/include/openssl/hmac.h:102: error: previous declaration of &#39;HMAC_CTX_copy&#39; was here
openssl_missing.h:95: error: conflicting types for &#39;EVP_CIPHER_CTX_copy&#39;
/opt/local/include/openssl/evp.h:503: error: previous declaration of &#39;EVP_CIPHER_CTX_copy&#39; was here
openssl_missing.c:27: error: conflicting types for &#39;HMAC_CTX_copy&#39;
/opt/local/include/openssl/hmac.h:102: error: previous declaration of &#39;HMAC_CTX_copy&#39; was here
openssl_missing.c:122: error: conflicting types for &#39;EVP_CIPHER_CTX_copy&#39;
/opt/local/include/openssl/evp.h:503: error: previous declaration of &#39;EVP_CIPHER_CTX_copy&#39; was here
make[2]: *** [openssl_missing.o] Error 1
make[1]: *** [ext/openssl/all] Error 2
make: *** [build-ext] Error 2
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;a href=&#34;http://d.hatena.ne.jp/todomasa/20110218/1298007883&#34; title=&#34;MacOSX v10.6.6でrvmを使ったruby1.9のインストールができない - todomasaの日記&#34;&gt;MacOSX v10.6.6でrvmを使ったruby1.9のインストールができない - todomasaの日記&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;↑を参考。openssl と readline を別に入れる必要があるみたい。ちなみに、今は &lt;code&gt;rvm package install&lt;/code&gt; から &lt;code&gt;rvm pkg install&lt;/code&gt; に名前が変わったので注意。&lt;/p&gt;

&lt;p&gt;とりあえず、rvm の update をする。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;koichi% rvm get stable
koichi% rvm --version

rvm 1.18.5 (stable) by Wayne E. Seguin &amp;lt;wayneeseguin@gmail.com&amp;gt;, Michal Papis &amp;lt;mpapis@gmail.com&amp;gt; [https://rvm.io/]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;で、openssl と readline をインストールしてみる。 インストールには結構時間がかかる。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;koichi% rvm pkg inatall openssl
Fetching openssl-1.0.1c.tar.gz to /Users/koichi/.rvm/archives
######################################################################## 100.0%
Extracting openssl to /Users/koichi/.rvm/src/openssl-1.0.1c
Configuring openssl in /Users/koichi/.rvm/src/openssl-1.0.1c.
Compiling openssl in /Users/koichi/.rvm/src/openssl-1.0.1c.
Installing openssl to /Users/koichi/.rvm/usr

Please note that it&#39;s required to reinstall all rubies:

    rvm reinstall all --force

Updating openssl certificates
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ここでしばらく止まってて、処理が続いてると思ったけど、エンター押したら進んだ。&lt;/p&gt;

&lt;p&gt;続いて readline。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;koichi% rvm pkg install readline
Fetching readline-5.2.tar.gz to /Users/koichi/.rvm/archives
######################################################################## 100.0%
Extracting readline to /Users/koichi/.rvm/src/readline-5.2
Applying patch &#39;/Users/koichi/.rvm/patches/readline-5.2/shobj-conf.patch&#39;...
Configuring readline in /Users/koichi/.rvm/src/readline-5.2.
Compiling readline in /Users/koichi/.rvm/src/readline-5.2.
Installing readline to /Users/koichi/.rvm/usr

Please note that it&#39;s required to reinstall all rubies:

    rvm reinstall all --force

Fetching readline-6.2.tar.gz to /Users/koichi/.rvm/archives
######################################################################## 100.0%
Extracting readline to /Users/koichi/.rvm/src/readline-6.2
Applying patch &#39;/Users/koichi/.rvm/patches/readline-6.2/patch-shobj-conf.diff&#39;...
Configuring readline in /Users/koichi/.rvm/src/readline-6.2.
Compiling readline in /Users/koichi/.rvm/src/readline-6.2.
Installing readline to /Users/koichi/.rvm/usr

Please note that it&#39;s required to reinstall all rubies:

    rvm reinstall all --force
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;なんで 5.2 と 6.2 をインストールしてるんだろう。Ruby のバージョンによって要求するバージョンが違うのかな。&lt;/p&gt;

&lt;p&gt;それでようやっと ruby のインストール。さっきインストールしたパッケージのディレクトリを指定する。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;koichi% rvm install ruby --with-openssl-dir=$HOME/.rvm/usr --with-readline-dir=$HOME/.rvm/usr
Installing Ruby from source to: /Users/koichi/.rvm/rubies/ruby-1.9.3-p374, this may take a while depending on your cpu(s)...
ruby-1.9.3-p374 - #downloading ruby-1.9.3-p374, this may take a while depending on your connection...
ruby-1.9.3-p374 - #extracted to /Users/koichi/.rvm/src/ruby-1.9.3-p374 (already extracted)
ruby-1.9.3-p374 - #configuring
ruby-1.9.3-p374 - #compiling
Error running &#39;make&#39;, please read /Users/koichi/.rvm/log/ruby-1.9.3-p374/make.log
There has been an error while running make. Halting the installation.
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;が… &lt;strong&gt;ダメ！！！！&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;make のエラーもさっきと同じ。うーん、openssl のインストールが怪しい感じだったから、そこが原因かなぁ。&lt;/p&gt;

&lt;p&gt;と思って &lt;code&gt;~/.rvm/log/&lt;/code&gt; らへんを見るけど、特に分からない。とりあえず、install 方法に間違いがあるかも、と思って &lt;code&gt;rvm help | less&lt;/code&gt; したら、 &lt;code&gt;rvm insatll&lt;/code&gt; の項目に公式へのリンクがはってあったので行ってみた。&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://rvm.io/rubies/installing/&#34; title=&#34;RVM: Ruby Version Manager - &#39;./install&#39; - Installing RVM.&#34;&gt;RVM: Ruby Version Manager - &amp;lsquo;./install&amp;rsquo; - Installing RVM.&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;そしたらこんな事が書いてあるじゃないですかー。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Find the requirements (follow the instructions):

    $ rvm requirements

Install ruby:

    $ rvm install 1.9.3
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;で、さっそく &lt;code&gt;rvm requirements&lt;/code&gt; からの、&lt;code&gt;brew install&lt;/code&gt; しようとしたらエラー。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;koichi% brew install autoconf automake apple-gcc42 libtool pkg-config openssl readline libyaml sqlite libxml2 libxslt libksba
Error: No available formula for apple-gcc42
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;こういう時は黙って &lt;code&gt;brew update&lt;/code&gt; してみる。再度 &lt;code&gt;brew insatll&lt;/code&gt; したら進んだ（なんかワーニングは出てたけど）。色々と必要なライブラリが足りてなかったみたい。。。&lt;/p&gt;

&lt;p&gt;もう一度、ruby のインストール。&lt;/p&gt;

&lt;p&gt;やっぱりダメ。さっきと同じ、openssl 周りでのエラー。何がだめなんだろう。とりあえず、関係無いと思うけど、 &lt;code&gt;brew insatll&lt;/code&gt; した時に XCode のバージョンが古いって言ってたから AppStore からアップデートする。結構時間かかる。そしたら OS のバージョンアップも…OS再起動する。戻ってきたけど何も変わらない。諸行無常。極楽浄土。小春日和。今までと違ったアプローチをとった記事を発見。&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://tech.tenki.cc/archives/62 &amp;quot;OS X (Lion&#34;&gt;OS X (Lion)へのrvmでのrubyインストール時にopenssl_missing.cでconflictingがでて失敗する問題の解消 | とりあえず残しとくか&lt;/a&gt;へのrvmでのrubyインストール時にopenssl_missing.cでconflictingがでて失敗する問題の解消 | とりあえず残しとくか&amp;rdquo;)&lt;/p&gt;

&lt;p&gt;これを試してみる。 &lt;code&gt;/opt/local/include/openssl/hmac.h&lt;/code&gt; の102行目と &lt;code&gt;/opt/local/include/openssl/evp.h:&lt;/code&gt; の503行目をコメントアウト。&lt;/p&gt;

&lt;p&gt;そして再度インストール。&lt;/p&gt;

&lt;p&gt;できた。&lt;/p&gt;

&lt;p&gt;** コンパイルできた！！！！ **&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;koichi% rvm install ruby --with-openssl-dir=$HOME/.rvm/usr --with-readline-dir=$HOME/.rvm/usr
Installing Ruby from source to: /Users/koichi/.rvm/rubies/ruby-1.9.3-p374, this may take a while depending on your cpu(s)...
ruby-1.9.3-p374 - #downloading ruby-1.9.3-p374, this may take a while depending on your connection...
ruby-1.9.3-p374 - #extracted to /Users/koichi/.rvm/src/ruby-1.9.3-p374 (already extracted)
ruby-1.9.3-p374 - #configuring
ruby-1.9.3-p374 - #compiling
ruby-1.9.3-p374 - #installing 
Retrieving rubygems-1.8.25
######################################################################## 100.0%
Extracting rubygems-1.8.25 ...
Removing old Rubygems files...
Installing rubygems-1.8.25 for ruby-1.9.3-p374 ...
Installation of rubygems completed successfully.
Saving wrappers to &#39;/Users/koichi/.rvm/bin&#39;.
ruby-1.9.3-p374 - #adjusting #shebangs for (gem irb erb ri rdoc testrb rake).
ruby-1.9.3-p374 - #importing default gemsets, this may take time ...
Install of ruby-1.9.3-p374 - #complete 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;でもこれでいいのか…な…まぁよしとしておこうか…そもそも、rvm のディレクトリ指定してるのになんで /opt/ 以下を見に行っているのか…うーん…&lt;/p&gt;

&lt;p&gt;やっぱりきちんとインストールできてなかったみたい。 &lt;code&gt;gem i bundler&lt;/code&gt; でエラー。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;koichi% gem i bundler
ERROR:  While executing gem ... (ArgumentError)
    negative string size (or size too big)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;これもエラー。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;koichi% gem install rubygems-update
ruby(71425,0x7fff7de79180) malloc: *** mmap(size=1152921504606851072) failed (error code=12)
*** error: can&#39;t allocate region
*** set a breakpoint in malloc_error_break to debug
ruby(71425,0x7fff7de79180) malloc: *** mmap(size=1152921504606851072) failed (error code=12)
*** error: can&#39;t allocate region
*** set a breakpoint in malloc_error_break to debug
/Users/koichi/.rvm/rubies/ruby-1.9.3-p374/lib/ruby/1.9.1/openssl/ssl-internal.rb:91:in `value&#39;: failed to allocate memory (NoMemoryError)
        from /Users/koichi/.rvm/rubies/ruby-1.9.3-p374/lib/ruby/1.9.1/openssl/ssl-internal.rb:91:in `block in verify_certificate_identity&#39;
        from /Users/koichi/.rvm/rubies/ruby-1.9.3-p374/lib/ruby/1.9.1/openssl/ssl-internal.rb:89:in `each&#39;
        from /Users/koichi/.rvm/rubies/ruby-1.9.3-p374/lib/ruby/1.9.1/openssl/ssl-internal.rb:89:in `verify_certificate_identity&#39;
        from /Users/koichi/.rvm/rubies/ruby-1.9.3-p374/lib/ruby/1.9.1/openssl/ssl-internal.rb:120:in `post_connection_check&#39;
        from /Users/koichi/.rvm/rubies/ruby-1.9.3-p374/lib/ruby/1.9.1/net/http.rb:801:in `connect&#39;
        from /Users/koichi/.rvm/rubies/ruby-1.9.3-p374/lib/ruby/1.9.1/net/http.rb:755:in `do_start&#39;
        from /Users/koichi/.rvm/rubies/ruby-1.9.3-p374/lib/ruby/1.9.1/net/http.rb:750:in `start&#39;
        from /Users/koichi/.rvm/rubies/ruby-1.9.3-p374/lib/ruby/site_ruby/1.9.1/rubygems/remote_fetcher.rb:329:in `connection_for&#39;
        from /Users/koichi/.rvm/rubies/ruby-1.9.3-p374/lib/ruby/site_ruby/1.9.1/rubygems/remote_fetcher.rb:413:in `request&#39;
        from /Users/koichi/.rvm/rubies/ruby-1.9.3-p374/lib/ruby/site_ruby/1.9.1/rubygems/remote_fetcher.rb:205:in `fetch_http&#39;
        from /Users/koichi/.rvm/rubies/ruby-1.9.3-p374/lib/ruby/site_ruby/1.9.1/rubygems/remote_fetcher.rb:220:in `fetch_http&#39;
        from /Users/koichi/.rvm/rubies/ruby-1.9.3-p374/lib/ruby/site_ruby/1.9.1/rubygems/remote_fetcher.rb:238:in `fetch_path&#39;
        from /Users/koichi/.rvm/rubies/ruby-1.9.3-p374/lib/ruby/site_ruby/1.9.1/rubygems/spec_fetcher.rb:260:in `load_specs&#39;
        from /Users/koichi/.rvm/rubies/ruby-1.9.3-p374/lib/ruby/site_ruby/1.9.1/rubygems/spec_fetcher.rb:231:in `block in list&#39;
        from /Users/koichi/.rvm/rubies/ruby-1.9.3-p374/lib/ruby/site_ruby/1.9.1/rubygems/spec_fetcher.rb:227:in `each&#39;
        from /Users/koichi/.rvm/rubies/ruby-1.9.3-p374/lib/ruby/site_ruby/1.9.1/rubygems/spec_fetcher.rb:227:in `list&#39;
        from /Users/koichi/.rvm/rubies/ruby-1.9.3-p374/lib/ruby/site_ruby/1.9.1/rubygems/spec_fetcher.rb:150:in `find_matching_with_errors&#39;
        from /Users/koichi/.rvm/rubies/ruby-1.9.3-p374/lib/ruby/site_ruby/1.9.1/rubygems/spec_fetcher.rb:89:in `fetch_with_errors&#39;
        from /Users/koichi/.rvm/rubies/ruby-1.9.3-p374/lib/ruby/site_ruby/1.9.1/rubygems/dependency_installer.rb:110:in `find_gems_with_sources&#39;
        from /Users/koichi/.rvm/rubies/ruby-1.9.3-p374/lib/ruby/site_ruby/1.9.1/rubygems/dependency_installer.rb:228:in `find_spec_by_name_and_version&#39;
        from /Users/koichi/.rvm/rubies/ruby-1.9.3-p374/lib/ruby/site_ruby/1.9.1/rubygems/dependency_installer.rb:259:in `install&#39;
        from /Users/koichi/.rvm/rubies/ruby-1.9.3-p374/lib/ruby/site_ruby/1.9.1/rubygems/commands/install_command.rb:121:in `block in execute&#39;
        from /Users/koichi/.rvm/rubies/ruby-1.9.3-p374/lib/ruby/site_ruby/1.9.1/rubygems/commands/install_command.rb:115:in `each&#39;
        from /Users/koichi/.rvm/rubies/ruby-1.9.3-p374/lib/ruby/site_ruby/1.9.1/rubygems/commands/install_command.rb:115:in `execute&#39;
        from /Users/koichi/.rvm/rubies/ruby-1.9.3-p374/lib/ruby/site_ruby/1.9.1/rubygems/command.rb:278:in `invoke&#39;
        from /Users/koichi/.rvm/rubies/ruby-1.9.3-p374/lib/ruby/site_ruby/1.9.1/rubygems/command_manager.rb:147:in `process_args&#39;
        from /Users/koichi/.rvm/rubies/ruby-1.9.3-p374/lib/ruby/site_ruby/1.9.1/rubygems/command_manager.rb:117:in `run&#39;
        from /Users/koichi/.rvm/rubies/ruby-1.9.3-p374/lib/ruby/site_ruby/1.9.1/rubygems/gem_runner.rb:65:in `run&#39;
        from /Users/koichi/.rvm/rubies/ruby-1.9.3-p374/bin/gem:25:in `&amp;lt;main&amp;gt;&#39;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;マジで積んだ気がする…&lt;/p&gt;

&lt;p&gt;とりあえず、さっきまでのやつを消す&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;koichi% rvm --force uninstall ruby-1.9.3-p374
Removing /Users/koichi/.rvm/src/ruby-1.9.3-p374...
Removing /Users/koichi/.rvm/rubies/ruby-1.9.3-p374...
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;再度 &lt;code&gt;rvm install&lt;/code&gt; インストールして先ほどと同じエラーが出る事を確認。そしてどうするかなー。とりあえず、MacPorts の openssl をアップデートしてみる…が、ダメ。どこかで、MacPorts で入れた openssl だとかじゃなくて、Homebrew で入れた openssl でインストールしろとか書いてあったので、MacPorts を前削除する方針で動く。以下を参考に。&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://yatmsu.hatenablog.com/entry/20120115/1326617749&#34; title=&#34;macportsからhomebrewへ移行 - 一分一秒真剣勝負！&#34;&gt;macportsからhomebrewへ移行 - 一分一秒真剣勝負！&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;で、さらば MacPorts こんにちは Homebrew したら、再び &lt;code&gt;rvm install&lt;/code&gt; 。だけど、今度は configure で落ちている模様。なんか C コンパイラーが無いとか。 &lt;code&gt;~/.zshrc&lt;/code&gt; には MacPorts の為に export していたパスがいくつかあったので削除してログアウト→ログイン、 &lt;code&gt;rvm install&lt;/code&gt; する。と、また make で落ちる。いつもの箇所。けど今度は、.rvm 以下のファイルを見て落ちている模様。こうなると、おそらく &lt;code&gt;pkg install&lt;/code&gt; したファイル群が良くないと思われるので、 &lt;code&gt;rm -rf ~/.rvm/usr&lt;/code&gt; して &lt;code&gt;pkg install&lt;/code&gt; したライブラリを消す。そして &lt;code&gt;rvm install&lt;/code&gt; 。&lt;/p&gt;

&lt;p&gt;今度こそコンパイルができた。 &lt;code&gt;gem install bundler&lt;/code&gt; も動く模様。 ここまで長かった…&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&#34;追記-2013-2-5:72ac6891991cc7b39ae5ac38c6897710&#34;&gt;追記(2013/2/5)&lt;/h3&gt;

&lt;p&gt;今まで MacPorts のライブラリや RVM パッケージでインストールしていた Ruby 達は、新たにインストールしなおさないと動かなくなる。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;rvm reinstall [target]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;で再インストールする必要がある。&lt;/p&gt;

&lt;p&gt;また、Ruby 1.8 系をインストールする際にエラーが出る事があるのだが、tk/tcl を先にインストールする必要がある（もしくはリンクしないオプションを指定する）。&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://stackoverflow.com/questions/12469530/getting-ruby-1-8-7-installed-on-mountain-lion-10-8 &amp;quot;rvm - Getting Ruby 1.8.7 installed on Mountain Lion (10.8&#34;&gt;rvm - Getting Ruby 1.8.7 installed on Mountain Lion (10.8) - Stack Overflow&lt;/a&gt; - Stack Overflow&amp;rdquo;)&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;just figured it out! Please reference this question on SO&lt;/p&gt;

&lt;p&gt;rvm can no longer install 1.8.7-p352 on Mac OS X Mountain Lion&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;rvm reinstall 1.8.7 --without-tcl --without-tk`
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Alternatively, try this installation order if you have Homebrew.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;brew install tcl

brew install tk

rvm reinstall 1.8.7`
&lt;/code&gt;&lt;/pre&gt;
&lt;/blockquote&gt;

&lt;p&gt;で、tk のインストールでエラー。Mountain Lion には、X11 のライブラリが無いらしく、brew にも登録がないらしいから、別途インストールする必要があるっぽい（エラーメッセージにも出てくる）。以下も参照。&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://memo.yomukaku.net/entries/SKNgCdP &amp;quot;X11 (XQuartz 2.7.2&#34;&gt;X11 (XQuartz 2.7.2)をMac OS X 10.8 Mountain Lionにインストールする - memo.yomukaku.net&lt;/a&gt;をMac OS X 10.8 Mountain Lionにインストールする - memo.yomukaku.net&amp;rdquo;)&lt;/p&gt;

&lt;p&gt;で、再度 &lt;code&gt;brew install tk&lt;/code&gt; すると、インストールが完了。&lt;/p&gt;

&lt;p&gt;で落ち着くと思ったら、なぜか ruby のインストールはうまくいかない。X11/Xlib.h が見つかってないっぽい。こんな記事を見つける。&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://stackoverflow.com/questions/11664835/mountain-lion-rvm-install-1-8-7-x11-error/11666019#11666019&#34; title=&#34;ruby - Mountain Lion rvm install 1.8.7 x11 error - Stack Overflow&#34;&gt;ruby - Mountain Lion rvm install 1.8.7 x11 error - Stack Overflow&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;で、上記記事通りやってもうまくいかない。install.log をよくみてみると、&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Valid [tclConfig.sh, tkConfig.sh] are found in [[&amp;quot;/usr/local/lib&amp;quot;, &amp;quot;/usr/local/lib&amp;quot;]]
Use [tclConfig.sh, tkConfig.sh] == [&amp;quot;/usr/local/lib/tclConfig.sh&amp;quot;, &amp;quot;/usr/local/lib/tkConfig.sh&amp;quot;]
Use MacOS X Frameworks.
Use X11 libraries (or use TK_XINCLUDES/TK_XLIBSW information on tkConfig.sh).
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;とかって書いてあるので、 &lt;code&gt;export TK_XINCLUDES=&#39;-I/opt/X11/include&#39;&lt;/code&gt; として実行してみる。だが、ダメ。しょうがないから、 &lt;code&gt;/usr/local/lib/tkConfig.sh&lt;/code&gt; を直接編集したる。以下のような感じ&lt;/p&gt;

&lt;p&gt;``` sh /usr/local/lib/tkConfig.sh 45行目辺り&lt;/p&gt;

&lt;h1 id=&#34;i-switch-es-to-use-to-make-all-of-the-x11-include-files-accessible:72ac6891991cc7b39ae5ac38c6897710&#34;&gt;-I switch(es) to use to make all of the X11 include files accessible:&lt;/h1&gt;

&lt;h1 id=&#34;tk-xincludes:72ac6891991cc7b39ae5ac38c6897710&#34;&gt;TK_XINCLUDES=&amp;rdquo;&lt;/h1&gt;

&lt;p&gt;TK_XINCLUDES=&amp;lsquo;-I/opt/X11/include&amp;rsquo;
```&lt;/p&gt;

&lt;p&gt;そしたらうまくインストールできた。でももしかしたら、 &lt;code&gt;TK_XINCLUDES&lt;/code&gt; を外から指定する方法があるかもしれない。&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>